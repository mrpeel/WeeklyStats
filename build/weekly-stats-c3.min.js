function assert(a,t){if(ASSERT_ENABLED&&!a){if(ASSERT_ERROR)throw new Error("Assertion failed"+typeof t=="undefined"?"":t);console.log("Assertion failed"),console.log("undefined"==typeof t?"":t)}}function setupRetrieval(a,t){"use strict";assert(isDate(a),"setupRetrieval assert failed - selectedDate: "+a),assert(""!==t,"setupRetrieval assert failed - sIds empty"),ids=t,changeRetrievalDate(a)}function changeRetrievalDate(a){"use strict";assert(isDate(a),"changeRetrievalDate assert failed - newDate: "+a);var t=new Date(a).getDay();t--,-1===t&&(t=6);var e=dateAdd(a,"d",-1*t);startDate&&startDate===e||(startDate=e,endDate=dateAdd(startDate,"d",6),retrieveData(),updateScreenDateSelection(startDate))}function returnLastFullWeekDate(){"use strict";var a=new Date;return 0===a.getDay()?a:dateAdd(a,"d",-7)}function retrieveData(){"use strict";assert(isDate(startDate),"retrieveData assert failed - startDate: "+startDate),assert(1===new Date(startDate).getDay(),"retrieveData assert failed - startDate is not Monday: "+startDate),assert(isDate(endDate),"retrieveData assert failed - endDate: "+endDate),assert(0===new Date(endDate).getDay(),"retrieveData assert failed - endDate is not Sunday: "+endDate),assert(""!==ids,"retrieveData assert failed - ids empty"),console.time("dataLoad"),retrievalId=Date.now();var a=retrievalId;gaRequester.clearQueryQueue(),disableAllLinks(),setDates(),setPages(),retrieveTopBrowsers(5).then(function(){return a===retrievalId?retrieveYearlyPages():!1}).then(function(){return a===retrievalId?retrieveWeeklyUsers():!1}).then(function(){return a===retrievalId?(loadSubPage("home"),disableAllLinks(),!0):!1}).then(function(){return a===retrievalId?retrieveYearlyUsers():!1}).then(function(){return a===retrievalId?retrieveWeeklySessions():!1}).then(function(){return a===retrievalId?retrieveYearlyBrowsers():!1}).then(function(){return a===retrievalId?retrieveVisitorReturns():!1}).then(function(){return a===retrievalId?retrieveTotalVisits():!1}).then(function(){return a===retrievalId?retrieveSearchTypes():!1}).then(function(){return a===retrievalId?retrieveMapTypes():!1}).then(function(){return a===retrievalId?retrieveActivities():!1}).then(function(){loadSubPage("specific"),hideLoadBar(),console.timeEnd("dataLoad")})["catch"](function(a){console.log(a)})}function setDates(){"use strict";assert(isDate(startDate),"setDates assert failed - startDate: "+startDate),assert(isDate(endDate),"setDates assert failed - endDate: "+endDate),currentWeekdayLabels.length=0,currentWeekdayLabels.push("x"),currentWeekdayLabels.push(formatDateString(startDate,"query")),currentWeekdayLabels.push(formatDateString(dateAdd(startDate,"d",1),"query")),currentWeekdayLabels.push(formatDateString(dateAdd(startDate,"d",2),"query")),currentWeekdayLabels.push(formatDateString(dateAdd(startDate,"d",3),"query")),currentWeekdayLabels.push(formatDateString(dateAdd(startDate,"d",4),"query")),currentWeekdayLabels.push(formatDateString(dateAdd(startDate,"d",5),"query")),currentWeekdayLabels.push(formatDateString(endDate,"query")),lastWeekStartDate=dateAdd(startDate,"d",-7),lastWeekEndDate=dateAdd(endDate,"d",-7),lastYearEndDate=endDatePreviousMonth(endDate),lastYearStartDate=dateAdd(dateAdd(lastYearEndDate,"y",-1),"d",1),previousYearStartDate=dateAdd(lastYearStartDate,"y",-1),previousYearEndDate=dateAdd(lastYearEndDate,"y",-1),last12MonthsLabels.length=0;for(var a=0;11>=a;a++)last12MonthsLabels.push(MONTH_LABELS[(lastYearStartDate.getMonth()+a)%12])}function setPages(){"use strict";topPagesFilter="",APP_NAMES.forEach(function(a){""!==topPagesFilter&&(topPagesFilter+=","),topPagesFilter=topPagesFilter+"ga:pageTitle=="+a,applicationData[a]={}})}function retrieveYearlyPages(){"use strict";return assert(isDate(startDate),"retrieveYearlyPages assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveYearlyPages assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveYearlyPages assert failed - topPagesFilter: "+topPagesFilter),new Promise(function(a,t){allApplicationData.pageData={},allApplicationData.pageTotals=[0,0,0,0,0,0,0,0,0,0,0,0],APP_NAMES.forEach(function(a){allApplicationData.pageData[a]=[0,0,0,0,0,0,0,0,0,0,0,0]}),gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,metrics:"ga:pageviews",dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth",filters:topPagesFilter,sort:"ga:pageTitle,ga:yearMonth"}).then(function(t){t&&(t.rows.forEach(function(a){allApplicationData.pageData[a[0]][+a[2]]=+a[3],allApplicationData.pageTotals[+a[2]]+=+a[3]}),APP_NAMES.forEach(function(a){for(var t=0;12>t;t++)allApplicationData.pageData[a][t]=roundTo2(allApplicationData.pageData[a][t]/allApplicationData.pageTotals[t]*100)})),a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveTopBrowsers(a){"use strict";return assert(isDate(startDate),"retrieveTopBrowsers assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveTopBrowsers assert failed - endDate: "+endDate),assert("number"==typeof a,"retrieveTopPages assert failed - numberToRetrieve: "+a),new Promise(function(t,e){topBrowsersFilter="",gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,metrics:"ga:pageviews",dimensions:"ga:browser",sort:"-ga:pageviews","max-results":a}).then(function(a){topBrowsersArray.length=0,a&&a.rows.forEach(function(a){""!==topBrowsersFilter&&(topBrowsersFilter+=","),topBrowsersFilter=topBrowsersFilter+"ga:browser=="+a[0],topBrowsersArray.push(a[0])}),t(!0)})["catch"](function(a){console.log(a),e(a)})})}function retrieveWeeklyUsers(){"use strict";return assert(isDate(startDate),"retrieveWeeklyUsers assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveWeeklyUsers assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveWeeklyUsers assert failed - topPagesFilter: "+topPagesFilter),new Promise(function(a,t){var e;allApplicationData.currentWeekUserData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].currentWeekUserData=[0,0,0,0,0,0,0];allApplicationData.lastWeekUserData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].lastWeekUserData=[0,0,0,0,0,0,0];allApplicationData.lastYearMedianUserData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].lastYearUserData=[[],[],[],[],[],[],[]],applicationData[e].lastYearMedianUserData=[0,0,0,0,0,0,0];gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:date,ga:nthDay",metrics:"ga:users",filters:topPagesFilter,sort:"ga:pageTitle,ga:date"}).then(function(a){return a&&a.rows.forEach(function(a){applicationData[a[0]].currentWeekUserData[+a[2]]=+a[3],allApplicationData.currentWeekUserData[+a[2]]+=+a[3]}),!0}).then(function(){return gaRequester.queryGA({"start-date":formatDateString(lastWeekStartDate,"query"),"end-date":formatDateString(lastWeekEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:date,ga:nthDay",metrics:"ga:users",filters:topPagesFilter,sort:"ga:pageTitle,ga:date"})}).then(function(a){return a&&a.rows.forEach(function(a){applicationData[a[0]].lastWeekUserData[+a[2]]=+a[3],allApplicationData.lastWeekUserData[+a[2]]+=+a[3]}),!0}).then(function(){return gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:dayOfWeek,ga:date",metrics:"ga:users",filters:topPagesFilter,sort:"ga:pageTitle,ga:date","max-results":1e4})}).then(function(t){var i;if(t){t.rows.forEach(function(a){i=+a[1]-1,-1===i&&(i=6),applicationData[a[0]].lastYearUserData[i].push(+a[3])});for(e in applicationData)for(var r=0;r<applicationData[e].lastYearUserData.length;r++){var s=applicationData[e].lastYearUserData[r].length,l=applicationData[e].lastYearUserData[r];sortNumericalArrayAsc(l),applicationData[e].lastYearMedianUserData[r]=l[Math.round(s/2)]||0,allApplicationData.lastYearMedianUserData[r]+=l[Math.round(s/2)]||0}}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveYearlyUsers(){"use strict";return assert(isDate(lastYearStartDate),"retrieveYearlyUsers assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveYearlyUsers assert failed - lastYearEndDate: "+lastYearEndDate),assert(isDate(previousYearStartDate),"retrieveYearlyUsers assert failed - previousYearStartDate: "+previousYearStartDate),assert(isDate(previousYearEndDate),"retrieveYearlyUsers assert failed - previousYearEndDate: "+previousYearEndDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveYearlyUsers assert failed - topPagesFilter: "+topPagesFilter),new Promise(function(a,t){var e;allApplicationData.thisYearUserData=[0,0,0,0,0,0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].thisYearUserData=[0,0,0,0,0,0,0,0,0,0,0,0];allApplicationData.previousYearUserData=[0,0,0,0,0,0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].previousYearUserData=[0,0,0,0,0,0,0,0,0,0,0,0];gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth",metrics:"ga:users",filters:topPagesFilter,sort:"ga:pageTitle,ga:yearMonth"}).then(function(a){return a&&a.rows.forEach(function(a){applicationData[a[0]].thisYearUserData[+a[2]]=+a[3],allApplicationData.thisYearUserData[+a[2]]+=+a[3]}),!0}).then(function(){return gaRequester.queryGA({"start-date":formatDateString(previousYearStartDate,"query"),"end-date":formatDateString(previousYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth",metrics:"ga:users",filters:topPagesFilter,sort:"ga:pageTitle,ga:nthMonth"})}).then(function(t){t&&t.rows.forEach(function(a){applicationData[a[0]].previousYearUserData[+a[2]]=+a[3],allApplicationData.previousYearUserData[+a[2]]+=+a[3]}),a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveWeeklySessions(){"use strict";return assert(isDate(startDate),"retrieveWeeklySeesions assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveWeeklySeesions assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveWeeklySeesions assert failed - topPagesFilter: "+topPagesFilter),new Promise(function(a,t){var e;allApplicationData.currentWeekSessionData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].currentWeekSessionData=[0,0,0,0,0,0,0];allApplicationData.lastWeekSessionData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].lastWeekSessionData=[0,0,0,0,0,0,0];gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:date,ga:nthDay",metrics:"ga:avgSessionDuration",filters:topPagesFilter,sort:"ga:pageTitle,ga:date"}).then(function(a){if(a){a.rows.forEach(function(a){applicationData[a[0]].currentWeekSessionData[+a[2]]=roundTo2(+a[3]/60),allApplicationData.currentWeekSessionData[+a[2]]+=roundTo2(+a[3]/60)});for(var t=0;t<allApplicationData.currentWeekSessionData.length;t++)allApplicationData.currentWeekSessionData[t]=roundTo2(allApplicationData.currentWeekSessionData[t]/APP_NAMES.length)}return!0}).then(function(){return gaRequester.queryGA({"start-date":formatDateString(lastWeekStartDate,"query"),"end-date":formatDateString(lastWeekEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:date,ga:nthDay",metrics:"ga:avgSessionDuration",filters:topPagesFilter,sort:"ga:pageTitle,ga:date"})}).then(function(a){if(a){a.rows.forEach(function(a){applicationData[a[0]].lastWeekSessionData[+a[2]]=roundTo2(+a[3]/60),allApplicationData.lastWeekSessionData[+a[2]]+=roundTo2(+a[3]/60)});for(var t=0;t<allApplicationData.lastWeekSessionData.length;t++)allApplicationData.lastWeekSessionData[t]=roundTo2(allApplicationData.lastWeekSessionData[t]/APP_NAMES.length)}return!0}).then(function(){return gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:dayOfWeek,ga:date",metrics:"ga:avgSessionDuration",filters:topPagesFilter,sort:"ga:pageTitle,ga:date","max-results":1e4})}).then(function(t){var e;allApplicationData.lastYearMedianSessionData=[0,0,0,0,0,0,0];for(e in applicationData)applicationData[e].lastYearSessionData=[[],[],[],[],[],[],[]],applicationData[e].lastYearMedianSessionData=[0,0,0,0,0,0,0];var i;if(t){t.rows.forEach(function(a){i=+a[1]-1,-1===i&&(i=6),applicationData[a[0]].lastYearSessionData[i].push(roundTo2(+a[3]/60))});for(e in applicationData)for(var r=0;r<applicationData[e].lastYearSessionData.length;r++){var s=applicationData[e].lastYearSessionData[r].length,l=applicationData[e].lastYearSessionData[r];sortNumericalArrayAsc(l),applicationData[e].lastYearMedianSessionData[r]=l[Math.round(s/2)]||0,allApplicationData.lastYearMedianSessionData[r]+=l[Math.round(s/2)]||0}for(var o=0;o<allApplicationData.lastYearMedianSessionData.length;o++)allApplicationData.lastYearMedianSessionData[o]=roundTo2(allApplicationData.lastYearMedianSessionData[o]/APP_NAMES.length)}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveYearlyBrowsers(){"use strict";return assert(isDate(lastYearStartDate),"retrieveYearlyBrowsers assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveYearlyBrowsers assert failed - lastYearEndDate: "+lastYearEndDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveYearlyBrowsers assert failed - topPagesFilter: "+topPagesFilter),assert("undefined"!=typeof topBrowsersFilter&&""!==topBrowsersFilter,"retrieveYearlyBrowsers assert failed - topBrowsersFilter: "+topBrowsersFilter),new Promise(function(a,t){gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:browser,ga:yearMonth,ga:nthMonth",metrics:"ga:pageviews",filters:topPagesFilter+";"+topBrowsersFilter,sort:"ga:pageTitle,ga:browser,ga:yearMonth"}).then(function(t){allApplicationData.browserData={},allApplicationData.browserTotals=[0,0,0,0,0,0,0,0,0,0,0,0],topBrowsersArray.forEach(function(a){allApplicationData.browserData[a]=[0,0,0,0,0,0,0,0,0,0,0,0]});for(var e in applicationData){applicationData[e].browserData={},applicationData[e].browserTotals=[0,0,0,0,0,0,0,0,0,0,0,0];for(var i=0;i<topBrowsersArray.length;i++)applicationData[e].browserData[topBrowsersArray[i]]=[0,0,0,0,0,0,0,0,0,0,0,0]}if(t){t.rows.forEach(function(a){applicationData[a[0]].browserData[a[1]][+a[3]]=+a[4],applicationData[a[0]].browserTotals[+a[3]]+=+a[4],allApplicationData.browserData[a[1]][+a[3]]+=+a[4],allApplicationData.browserTotals[+a[3]]+=+a[4]}),topBrowsersArray.forEach(function(a){for(var t=0;12>t;t++)allApplicationData.browserData[a][t]=roundTo2(allApplicationData.browserData[a][t]/allApplicationData.browserTotals[t]*100)});for(var r in applicationData)for(var s=0;s<topBrowsersArray.length;s++)for(var l=topBrowsersArray[s],o=0;12>o;o++)applicationData[r].browserData[l][o]=roundTo2(applicationData[r].browserData[l][o]/applicationData[r].browserTotals[o]*100)}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveVisitorReturns(){"use strict";return assert(isDate(previousYearStartDate),"retrieveVisitorReturns assert failed - lastYearStartDate: "+previousYearStartDate),assert(isDate(lastYearEndDate),"retrieveVisitorReturns assert failed - lastYearEndDate: "+lastYearEndDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveVisitorReturns assert failed - topPagesFilter: "+topPagesFilter),new Promise(function(a,t){gaRequester.queryGA({"start-date":formatDateString(previousYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:userType",metrics:"ga:pageviews",filters:topPagesFilter,sort:"ga:pageTitle,ga:userType"}).then(function(a){allApplicationData.visitorReturns={},allApplicationData.visitorReturns["New visitors"]=0,allApplicationData.visitorTotal=0;for(var t in applicationData)applicationData[t].visitorReturns={},applicationData[t].visitorReturns["New visitors"]=0,applicationData[t].visitorTotal=0;return a&&a.rows.forEach(function(a){"New Visitor"===a[1]&&(applicationData[a[0]].visitorReturns["New visitors"]=+a[2],applicationData[a[0]].visitorTotal+=+a[2],allApplicationData.visitorReturns["New visitors"]+=+a[2],allApplicationData.visitorTotal+=+a[2])}),gaRequester.queryGA({"start-date":formatDateString(previousYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:daysSinceLastSession",metrics:"ga:pageviews",filters:topPagesFilter,sort:"ga:pageTitle,ga:daysSinceLastSession"})}).then(function(t){allApplicationData.visitorReturns["Returned within a day"]=0,allApplicationData.visitorReturns["Returned within a week"]=0,allApplicationData.visitorReturns["Returned within a month"]=0,allApplicationData.visitorReturns["Returned within a year"]=0;for(var e in applicationData)applicationData[e].visitorReturns["Returned within a day"]=0,applicationData[e].visitorReturns["Returned within a week"]=0,applicationData[e].visitorReturns["Returned within a month"]=0,applicationData[e].visitorReturns["Returned within a year"]=0;t&&t.rows.forEach(function(a){+a[1]<=1?(applicationData[a[0]].visitorReturns["Returned within a day"]+=+a[2],allApplicationData.visitorReturns["Returned within a day"]+=+a[2]):+a[1]>1&&+a[1]<=7?(applicationData[a[0]].visitorReturns["Returned within a week"]+=+a[2],allApplicationData.visitorReturns["Returned within a week"]+=+a[2]):+a[1]>7&&+a[1]<=31?(applicationData[a[0]].visitorReturns["Returned within a month"]+=+a[2],allApplicationData.visitorReturns["Returned within a month"]+=+a[2]):+a[1]>31&&+a[1]<=365&&(applicationData[a[0]].visitorReturns["Returned within a year"]+=+a[2],allApplicationData.visitorReturns["Returned within a year"]+=+a[2]),applicationData[a[0]].visitorTotal+=+a[2],allApplicationData.visitorTotal+=+a[2]}),allApplicationData.visitorReturns.data=[],allApplicationData.visitorReturns.data.push([]),allApplicationData.visitorReturns.data[0].push("New visitors"),allApplicationData.visitorReturns.data[0].push(allApplicationData.visitorReturns["New visitors"]),allApplicationData.visitorReturns.data.push([]),allApplicationData.visitorReturns.data[1].push("Returned within a day"),allApplicationData.visitorReturns.data[1].push(allApplicationData.visitorReturns["Returned within a day"]),allApplicationData.visitorReturns.data.push([]),allApplicationData.visitorReturns.data[2].push("Returned within a week"),allApplicationData.visitorReturns.data[2].push(allApplicationData.visitorReturns["Returned within a week"]),allApplicationData.visitorReturns.data.push([]),allApplicationData.visitorReturns.data[3].push("Returned within a month"),allApplicationData.visitorReturns.data[3].push(allApplicationData.visitorReturns["Returned within a month"]),allApplicationData.visitorReturns.data.push([]),allApplicationData.visitorReturns.data[4].push("Returned within a year"),allApplicationData.visitorReturns.data[4].push(allApplicationData.visitorReturns["Returned within a year"]),sortNumericalArrayDesc(allApplicationData.visitorReturns.data,1),allApplicationData.visitorReturns.labels=[],allApplicationData.visitorReturns.data.forEach(function(a){allApplicationData.visitorReturns.labels.push(a[0]+": "+a[1]+" ("+Math.round(a[1]/allApplicationData.visitorTotal*100)+"%)")});for(var i in applicationData){applicationData[i].visitorReturns.data=[],applicationData[i].visitorReturns.data.push([]),applicationData[i].visitorReturns.data[0].push("New visitors"),applicationData[i].visitorReturns.data[0].push(applicationData[i].visitorReturns["New visitors"]),applicationData[i].visitorReturns.data.push([]),applicationData[i].visitorReturns.data[1].push("Returned within a day"),applicationData[i].visitorReturns.data[1].push(applicationData[i].visitorReturns["Returned within a day"]),applicationData[i].visitorReturns.data.push([]),applicationData[i].visitorReturns.data[2].push("Returned within a week"),applicationData[i].visitorReturns.data[2].push(applicationData[i].visitorReturns["Returned within a week"]),applicationData[i].visitorReturns.data.push([]),applicationData[i].visitorReturns.data[3].push("Returned within a month"),applicationData[i].visitorReturns.data[3].push(applicationData[i].visitorReturns["Returned within a month"]),applicationData[i].visitorReturns.data.push([]),applicationData[i].visitorReturns.data[4].push("Returned within a year"),applicationData[i].visitorReturns.data[4].push(applicationData[i].visitorReturns["Returned within a year"]),sortNumericalArrayDesc(applicationData[i].visitorReturns.data,1),applicationData[i].visitorReturns.labels=[];for(var r=0;r<applicationData[i].visitorReturns.data.length;r++){var s=applicationData[i].visitorReturns.data[r];applicationData[i].visitorReturns.labels.push(s[0]+": "+s[1]+" ("+Math.round(s[1]/applicationData[i].visitorTotal*100)+"%)")}}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveTotalVisits(){"use strict";return assert(isDate(startDate),"retrieveSearchTypes assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveSearchTypes assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveSearchTypes assert failed - topPagesFilter: "+topPagesFilter),assert(isDate(lastYearStartDate),"retrieveVisitorReturns assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveVisitorReturns assert failed - lastYearEndDate: "+lastYearEndDate),new Promise(function(a,t){gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:topPagesFilter,sort:"ga:pageTitle"}).then(function(a){allApplicationData.totalVisitsForWeek=0;for(var t in applicationData)applicationData[t].totalVisitsForWeek=0;return a&&a.rows.forEach(function(a){applicationData[a[0]].totalVisitsForWeek=+a[1],allApplicationData.totalVisitsForWeek=allApplicationData.totalVisitsForWeek+ +a[1]}),gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth",metrics:"ga:pageviews",filters:topPagesFilter,sort:"ga:pageTitle,ga:yearMonth"})}).then(function(t){allApplicationData.totalVisitsForYear=[0,0,0,0,0,0,0,0,0,0,0,0];for(var e in applicationData)applicationData[e].totalVisitsForYear=[0,0,0,0,0,0,0,0,0,0,0,0];t&&t.rows.forEach(function(a){applicationData[a[0]].totalVisitsForYear[+a[2]]=+a[3],allApplicationData.totalVisitsForYear[+a[2]]+=+a[3]}),a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveSearchTypes(){"use strict";return assert(isDate(startDate),"retrieveSearchTypes assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveSearchTypes assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveSearchTypes assert failed - topPagesFilter: "+topPagesFilter),assert(isDate(lastYearStartDate),"retrieveSearchTypes assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveSearchTypes assert failed - lastYearEndDate: "+lastYearEndDate),assert("undefined"!=typeof allApplicationData.totalVisitsForWeek,"retrieveSearchTypes assert failed - allApplicationData.totalVisitsForWeek does not exist"),assert("undefined"!=typeof allApplicationData.totalVisitsForYear,"retrieveSearchTypes assert failed - allApplicationData.totalVisitsForYear does not exist"),new Promise(function(a,t){gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:eventAction,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventAction==search",sort:"ga:pageTitle,-ga:totalEvents"}).then(function(a){allApplicationData.weekSearchTypes={},allApplicationData.weekSearchTypes.rawValues={},allApplicationData.weekSearchTypes.totalSearches=0,allApplicationData.weekSearchTypes.data=[],allApplicationData.weekSearchTypes.labels=[],allApplicationData.weekSearchTypes.dataPerVisit=[],allApplicationData.weekSearchTypes.labelsPerVisit=[];for(var t in applicationData)applicationData[t].weekSearchTypes={},applicationData[t].weekSearchTypes.rawValues={},applicationData[t].weekSearchTypes.totalSearches=0,applicationData[t].weekSearchTypes.data=[],applicationData[t].weekSearchTypes.labels=[],applicationData[t].weekSearchTypes.dataPerVisit=[],applicationData[t].weekSearchTypes.labelsPerVisit=[];if(a){a.rows.forEach(function(a){applicationData[a[0]].weekSearchTypes.rawValues[a[2]]=+a[3],allApplicationData.weekSearchTypes.rawValues[a[2]]||(allApplicationData.weekSearchTypes.rawValues[a[2]]=0),allApplicationData.weekSearchTypes.rawValues[a[2]]+=+a[3],applicationData[a[0]].weekSearchTypes.totalSearches+=+a[3],allApplicationData.weekSearchTypes.totalSearches+=+a[3]});for(var e in applicationData){for(var i in applicationData[e].weekSearchTypes.rawValues){var r=applicationData[e].weekSearchTypes.data.length;applicationData[e].weekSearchTypes.data.push([]),applicationData[e].weekSearchTypes.data[r].push(i),applicationData[e].weekSearchTypes.data[r].push(applicationData[e].weekSearchTypes.rawValues[i]),applicationData[e].weekSearchTypes.dataPerVisit.push([]),applicationData[e].weekSearchTypes.dataPerVisit[r].push(i),applicationData[e].weekSearchTypes.dataPerVisit[r].push(roundTo2(applicationData[e].weekSearchTypes.rawValues[i]/applicationData[e].totalVisitsForWeek))}sortNumericalArrayDesc(applicationData[e].weekSearchTypes.data,1),sortNumericalArrayDesc(applicationData[e].weekSearchTypes.dataPerVisit,1);for(var s=0;s<applicationData[e].weekSearchTypes.data.length;s++){var l=applicationData[e].weekSearchTypes.data[s];applicationData[e].weekSearchTypes.labels.push(l[0]+": "+l[1]+" ("+Math.round(l[1]/(applicationData[e].weekSearchTypes.totalSearches||1)*100)+"%)")}for(var o=0;o<applicationData[e].weekSearchTypes.dataPerVisit.length;o++){var n=applicationData[e].weekSearchTypes.dataPerVisit[o];applicationData[e].weekSearchTypes.labelsPerVisit.push(n[0]+": "+n[1]+" times per visit")}}for(var c in allApplicationData.weekSearchTypes.rawValues){var p=allApplicationData.weekSearchTypes.data.length;allApplicationData.weekSearchTypes.data.push([]),allApplicationData.weekSearchTypes.data[p].push(c),allApplicationData.weekSearchTypes.data[p].push(allApplicationData.weekSearchTypes.rawValues[c]),allApplicationData.weekSearchTypes.dataPerVisit.push([]),allApplicationData.weekSearchTypes.dataPerVisit[p].push(c),allApplicationData.weekSearchTypes.dataPerVisit[p].push(roundTo2(allApplicationData.weekSearchTypes.rawValues[c]/(allApplicationData.totalVisitsForWeek||1)))}sortNumericalArrayDesc(allApplicationData.weekSearchTypes.data,1),sortNumericalArrayDesc(allApplicationData.weekSearchTypes.dataPerVisit,1),allApplicationData.weekSearchTypes.data.forEach(function(a){allApplicationData.weekSearchTypes.labels.push(a[0]+": "+a[1]+" ("+Math.round(a[1]/(allApplicationData.weekSearchTypes.totalSearches||1)*100)+"%)")}),allApplicationData.weekSearchTypes.dataPerVisit.forEach(function(a){allApplicationData.weekSearchTypes.labelsPerVisit.push(a[0]+": "+a[1]+" times per visit")})}return gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth,ga:eventAction,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventAction==search",sort:"ga:pageTitle,ga:yearMonth,ga:nthMonth"})}).then(function(t){allApplicationData.yearSearchTypes={},allApplicationData.yearSearchTypes.rawValues={},allApplicationData.yearSearchTypes.monthTotals=[0,0,0,0,0,0,0,0,0,0,0,0],allApplicationData.yearSearchTypes.data=[];for(var e in applicationData)applicationData[e].yearSearchTypes={},applicationData[e].yearSearchTypes.rawValues={},applicationData[e].yearSearchTypes.monthTotals=[0,0,0,0,0,0,0,0,0,0,0,0],applicationData[e].yearSearchTypes.data=[];if(t){t.rows.forEach(function(a){applicationData[a[0]].yearSearchTypes.rawValues[a[4]]||(applicationData[a[0]].yearSearchTypes.rawValues[a[4]]=[0,0,0,0,0,0,0,0,0,0,0,0]),applicationData[a[0]].yearSearchTypes.rawValues[a[4]][+a[2]]=+a[5],applicationData[a[0]].yearSearchTypes.monthTotals[+a[2]]+=+a[5],allApplicationData.yearSearchTypes.rawValues[a[4]]||(allApplicationData.yearSearchTypes.rawValues[a[4]]=[0,0,0,0,0,0,0,0,0,0,0,0]),allApplicationData.yearSearchTypes.rawValues[a[4]][+a[2]]+=+a[5],allApplicationData.yearSearchTypes.monthTotals[+a[2]]+=+a[5]});for(var i in applicationData)for(var r in applicationData[i].yearSearchTypes.rawValues){var s=applicationData[i].yearSearchTypes.data.length;applicationData[i].yearSearchTypes.data.push([]),applicationData[i].yearSearchTypes.data[s].push(r);for(var l=0;12>l;l++)applicationData[i].yearSearchTypes.data[s].push(roundTo2(applicationData[i].yearSearchTypes.rawValues[r][l]/(applicationData[i].yearSearchTypes.monthTotals[l]||1)*100))}for(var o in allApplicationData.yearSearchTypes.rawValues){var n=allApplicationData.yearSearchTypes.data.length;allApplicationData.yearSearchTypes.data.push([]),allApplicationData.yearSearchTypes.data[n].push(o);for(var c=0;12>c;c++)allApplicationData.yearSearchTypes.data[n].push(roundTo2(allApplicationData.yearSearchTypes.rawValues[o][c]/(allApplicationData.yearSearchTypes.monthTotals[c]||1)*100))}}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveMapTypes(){"use strict";return assert(isDate(startDate),"retrieveMapTypes assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveMapTypes assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveMapTypes assert failed - topPagesFilter: "+topPagesFilter),assert(isDate(lastYearStartDate),"retrieveMapTypes assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveMapTypes assert failed - lastYearEndDate: "+lastYearEndDate),assert("undefined"!=typeof allApplicationData.totalVisitsForWeek,"retrieveMapTypes assert failed - allApplicationData.totalVisitsForWeek does not exist"),assert("undefined"!=typeof allApplicationData.totalVisitsForYear,"retrieveMapTypes assert failed - allApplicationData.totalVisitsForYear does not exist"),new Promise(function(a,t){gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:eventAction,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventAction==default,ga:eventLabel==Victoria,ga:eventLabel==Map,ga:eventLabel==Imagery",sort:"ga:pageTitle,-ga:totalEvents"}).then(function(a){allApplicationData.weekMapTypes={},allApplicationData.weekMapTypes.rawValues={},allApplicationData.weekMapTypes.totalMaps=0,allApplicationData.weekMapTypes.data=[],allApplicationData.weekMapTypes.labels=[];for(var t in applicationData)applicationData[t].weekMapTypes={},applicationData[t].weekMapTypes.rawValues={},applicationData[t].weekMapTypes.totalMaps=0,applicationData[t].weekMapTypes.data=[],applicationData[t].weekMapTypes.labels=[];if(a){a.rows.forEach(function(a){var t;t="default"===a[1]?"Default map":a[2],applicationData[a[0]].weekMapTypes.rawValues[t]=+a[3],allApplicationData.weekMapTypes.rawValues[t]||(allApplicationData.weekMapTypes.rawValues[t]=0),allApplicationData.weekMapTypes.rawValues[t]+=+a[3],applicationData[a[0]].weekMapTypes.totalMaps+=+a[3],allApplicationData.weekMapTypes.totalMaps+=+a[3]});for(var e in applicationData){
for(var i in applicationData[e].weekMapTypes.rawValues){var r=applicationData[e].weekMapTypes.data.length;applicationData[e].weekMapTypes.data.push([]),applicationData[e].weekMapTypes.data[r].push(i),applicationData[e].weekMapTypes.data[r].push(applicationData[e].weekMapTypes.rawValues[i])}sortNumericalArrayDesc(applicationData[e].weekMapTypes.data,1);for(var s=0;s<applicationData[e].weekMapTypes.data.length;s++){var l=applicationData[e].weekMapTypes.data[s];applicationData[e].weekMapTypes.labels.push(l[0]+": "+l[1]+" ("+Math.round(l[1]/(applicationData[e].weekMapTypes.totalMaps||1)*100)+"%)")}}for(var o in allApplicationData.weekMapTypes.rawValues){var n=allApplicationData.weekMapTypes.data.length;allApplicationData.weekMapTypes.data.push([]),allApplicationData.weekMapTypes.data[n].push(o),allApplicationData.weekMapTypes.data[n].push(allApplicationData.weekMapTypes.rawValues[o])}sortNumericalArrayDesc(allApplicationData.weekMapTypes.data,1),allApplicationData.weekMapTypes.data.forEach(function(a){allApplicationData.weekMapTypes.labels.push(a[0]+": "+a[1]+" ("+Math.round(a[1]/(allApplicationData.weekMapTypes.totalMaps||1)*100)+"%)")})}return gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth,ga:eventAction,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventAction==default,ga:eventLabel==Victoria,ga:eventLabel==Map,ga:eventLabel==Imagery",sort:"ga:pageTitle,ga:yearMonth,ga:nthMonth,-ga:totalEvents"})}).then(function(t){allApplicationData.yearMapTypes={},allApplicationData.yearMapTypes.rawValues={},allApplicationData.yearMapTypes.monthTotals=[0,0,0,0,0,0,0,0,0,0,0,0],allApplicationData.yearMapTypes.data=[];for(var e in applicationData)applicationData[e].yearMapTypes={},applicationData[e].yearMapTypes.rawValues={},applicationData[e].yearMapTypes.monthTotals=[0,0,0,0,0,0,0,0,0,0,0,0],applicationData[e].yearMapTypes.data=[];if(t){t.rows.forEach(function(a){var t;t="default"===a[3]?"Default map":a[4],applicationData[a[0]].yearMapTypes.rawValues[t]||(applicationData[a[0]].yearMapTypes.rawValues[t]=[0,0,0,0,0,0,0,0,0,0,0,0]),applicationData[a[0]].yearMapTypes.rawValues[t][+a[2]]=+a[5],applicationData[a[0]].yearMapTypes.monthTotals[+a[2]]+=+a[5],allApplicationData.yearMapTypes.rawValues[t]||(allApplicationData.yearMapTypes.rawValues[t]=[0,0,0,0,0,0,0,0,0,0,0,0]),allApplicationData.yearMapTypes.rawValues[t][+a[2]]+=+a[5],allApplicationData.yearMapTypes.monthTotals[+a[2]]+=+a[5]});for(var i in applicationData)for(var r in applicationData[i].yearMapTypes.rawValues){var s=applicationData[i].yearMapTypes.data.length;applicationData[i].yearMapTypes.data.push([]),applicationData[i].yearMapTypes.data[s].push(r);for(var l=0;12>l;l++)applicationData[i].yearMapTypes.data[s].push(roundTo2(applicationData[i].yearMapTypes.rawValues[r][l]/(applicationData[i].yearMapTypes.monthTotals[l]||1)*100))}for(var o in allApplicationData.yearMapTypes.rawValues){var n=allApplicationData.yearMapTypes.data.length;allApplicationData.yearMapTypes.data.push([]),allApplicationData.yearMapTypes.data[n].push(o);for(var c=0;12>c;c++)allApplicationData.yearMapTypes.data[n].push(roundTo2(allApplicationData.yearMapTypes.rawValues[o][c]/(allApplicationData.yearMapTypes.monthTotals[c]||1)*100))}}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveActivities(){"use strict";return assert(isDate(startDate),"retrieveActivities assert failed - startDate: "+startDate),assert(isDate(endDate),"retrieveActivities assert failed - endDate: "+endDate),assert("undefined"!=typeof topPagesFilter&&""!==topPagesFilter,"retrieveActivities assert failed - topPagesFilter: "+topPagesFilter),assert(isDate(lastYearStartDate),"retrieveActivities assert failed - lastYearStartDate: "+lastYearStartDate),assert(isDate(lastYearEndDate),"retrieveActivities assert failed - lastYearEndDate: "+lastYearEndDate),assert("undefined"!=typeof allApplicationData.totalVisitsForWeek,"retrieveActivities assert failed - allApplicationData.totalVisitsForWeek does not exist"),assert("undefined"!=typeof allApplicationData.totalVisitsForYear,"retrieveActivities assert failed - allApplicationData.totalVisitsForYear does not exist"),assert("undefined"!=typeof allApplicationData.weekSearchTypes.totalSearches,"retrieveActivities assert failed - allApplicationData.weekSearchTypes.totalSearches does not exist"),assert("undefined"!=typeof allApplicationData.yearSearchTypes.monthTotals,"retrieveActivities assert failed - allApplicationData.monthTotals does not exist"),new Promise(function(a,t){allApplicationData.weekActivities={},allApplicationData.weekActivities.rawValues={},allApplicationData.weekActivities.rawValues.Search=allApplicationData.weekSearchTypes.totalSearches,allApplicationData.weekActivities.totalActivities=allApplicationData.weekSearchTypes.totalSearches,allApplicationData.weekActivities.data=[],allApplicationData.weekActivities.labels=[],allApplicationData.weekActivities.dataPerVisit=[],allApplicationData.weekActivities.labelsPerVisit=[],allApplicationData.weekActivityTypes={},allApplicationData.weekActivityTypes.rawValues={},allApplicationData.weekActivityTypes.rawValues.Search=allApplicationData.weekSearchTypes.totalSearches,allApplicationData.weekActivityTypes.data=[],allApplicationData.weekActivityTypes.labels=[],allApplicationData.weekActivityTypes.dataPerVisit=[],allApplicationData.weekActivityTypes.labelsPerVisit=[],allApplicationData.yearActivities={},allApplicationData.yearActivities.rawValues={},allApplicationData.yearActivities.rawValues.Search=allApplicationData.yearSearchTypes.monthTotals.slice(),allApplicationData.yearActivities.monthTotals=allApplicationData.yearSearchTypes.monthTotals.slice(),allApplicationData.yearActivities.data=[],allApplicationData.yearActivityTypes={},allApplicationData.yearActivityTypes.rawValues={},allApplicationData.yearActivityTypes.rawValues.Search=allApplicationData.yearSearchTypes.monthTotals.slice(),allApplicationData.yearActivityTypes.data=[];for(var e in applicationData)applicationData[e].weekActivities={},applicationData[e].weekActivities.rawValues={},applicationData[e].weekActivities.rawValues.Search=applicationData[e].weekSearchTypes.totalSearches,applicationData[e].weekActivities.totalActivities=applicationData[e].weekSearchTypes.totalSearches,applicationData[e].weekActivities.data=[],applicationData[e].weekActivities.labels=[],applicationData[e].weekActivities.dataPerVisit=[],applicationData[e].weekActivities.labelsPerVisit=[],applicationData[e].weekActivityTypes={},applicationData[e].weekActivityTypes.rawValues={},applicationData[e].weekActivityTypes.rawValues.Search=applicationData[e].weekSearchTypes.totalSearches,applicationData[e].weekActivityTypes.data=[],applicationData[e].weekActivityTypes.labels=[],applicationData[e].weekActivityTypes.dataPerVisit=[],applicationData[e].weekActivityTypes.labelsPerVisit=[],applicationData[e].yearActivities={},applicationData[e].yearActivities.rawValues={},applicationData[e].yearActivities.rawValues.Search=applicationData[e].yearSearchTypes.monthTotals.slice(),applicationData[e].yearActivities.monthTotals=applicationData[e].yearSearchTypes.monthTotals.slice(),applicationData[e].yearActivities.data=[],applicationData[e].yearActivityTypes={},applicationData[e].yearActivityTypes.rawValues={},applicationData[e].yearActivityTypes.rawValues.Search=applicationData[e].yearSearchTypes.monthTotals.slice(),applicationData[e].yearActivityTypes.data=[];gaRequester.queryGA({"start-date":formatDateString(startDate,"query"),"end-date":formatDateString(endDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventLabel!=Victoria;ga:eventLabel!=Map;ga:eventLabel!=Imagery;ga:eventAction==click",sort:"ga:pageTitle,-ga:totalEvents","max-results":1e4}).then(function(a){if(a){a.rows.forEach(function(a){var t=retrieveActivityType(a[1]);applicationData[a[0]].weekActivities.rawValues[a[1]]=+a[2],applicationData[a[0]].weekActivityTypes.rawValues[t]||(applicationData[a[0]].weekActivityTypes.rawValues[t]=0),applicationData[a[0]].weekActivityTypes.rawValues[t]+=+a[2],allApplicationData.weekActivities.rawValues[a[1]]||(allApplicationData.weekActivities.rawValues[a[1]]=0),allApplicationData.weekActivities.rawValues[a[1]]+=+a[2],allApplicationData.weekActivityTypes.rawValues[t]||(allApplicationData.weekActivityTypes.rawValues[t]=0),allApplicationData.weekActivityTypes.rawValues[t]+=+a[2],applicationData[a[0]].weekActivities.totalActivities+=+a[2],allApplicationData.weekActivities.totalActivities+=+a[2]});for(var t in applicationData){for(var e in applicationData[t].weekActivities.rawValues){var i=applicationData[t].weekActivities.data.length;applicationData[t].weekActivities.data.push([]),applicationData[t].weekActivities.data[i].push(e),applicationData[t].weekActivities.data[i].push(applicationData[t].weekActivities.rawValues[e]),applicationData[t].weekActivities.dataPerVisit.push([]),applicationData[t].weekActivities.dataPerVisit[i].push(e),applicationData[t].weekActivities.dataPerVisit[i].push(roundTo2(applicationData[t].weekActivities.rawValues[e]/applicationData[t].totalVisitsForWeek))}sortNumericalArrayDesc(applicationData[t].weekActivities.data,1),sortNumericalArrayDesc(applicationData[t].weekActivities.dataPerVisit,1);for(var r=0;r<applicationData[t].weekActivities.data.length;r++){var s=applicationData[t].weekActivities.data[r];applicationData[t].weekActivities.labels.push(s[0]+": "+s[1]+" ("+Math.round(s[1]/(applicationData[t].weekActivities.totalActivities||1)*100)+"%)")}for(var l=0;l<applicationData[t].weekActivities.dataPerVisit.length;l++){var o=applicationData[t].weekActivities.dataPerVisit[l];applicationData[t].weekActivities.labelsPerVisit.push(o[0]+": "+o[1]+" times per visit")}for(var n in applicationData[t].weekActivityTypes.rawValues){var c=applicationData[t].weekActivityTypes.data.length;applicationData[t].weekActivityTypes.data.push([]),applicationData[t].weekActivityTypes.data[c].push(n),applicationData[t].weekActivityTypes.data[c].push(applicationData[t].weekActivityTypes.rawValues[n]),applicationData[t].weekActivityTypes.dataPerVisit.push([]),applicationData[t].weekActivityTypes.dataPerVisit[c].push(n),applicationData[t].weekActivityTypes.dataPerVisit[c].push(roundTo2(applicationData[t].weekActivityTypes.rawValues[n]/applicationData[t].totalVisitsForWeek))}sortNumericalArrayDesc(applicationData[t].weekActivityTypes.data,1),sortNumericalArrayDesc(applicationData[t].weekActivityTypes.dataPerVisit,1);for(var p=0;p<applicationData[t].weekActivityTypes.data.length;p++){var d=applicationData[t].weekActivityTypes.data[p];applicationData[t].weekActivityTypes.labels.push(d[0]+": "+d[1]+" ("+Math.round(d[1]/(applicationData[t].weekActivities.totalActivities||1)*100)+"%)")}for(var u=0;u<applicationData[t].weekActivityTypes.dataPerVisit.length;u++){var y=applicationData[t].weekActivityTypes.dataPerVisit[u];applicationData[t].weekActivityTypes.labelsPerVisit.push(y[0]+": "+y[1]+" times per visit")}}for(var h in allApplicationData.weekActivities.rawValues){var v=allApplicationData.weekActivities.data.length;allApplicationData.weekActivities.data.push([]),allApplicationData.weekActivities.data[v].push(h),allApplicationData.weekActivities.data[v].push(allApplicationData.weekActivities.rawValues[h]),allApplicationData.weekActivities.dataPerVisit.push([]),allApplicationData.weekActivities.dataPerVisit[v].push(h),allApplicationData.weekActivities.dataPerVisit[v].push(roundTo2(allApplicationData.weekActivities.rawValues[h]/(allApplicationData.totalVisitsForWeek||1)))}sortNumericalArrayDesc(allApplicationData.weekActivities.data,1),sortNumericalArrayDesc(allApplicationData.weekActivities.dataPerVisit,1),allApplicationData.weekActivities.data.forEach(function(a){allApplicationData.weekActivities.labels.push(a[0]+": "+a[1]+" ("+Math.round(a[1]/(allApplicationData.weekActivities.totalActivities||1)*100)+"%)")}),allApplicationData.weekActivities.dataPerVisit.forEach(function(a){allApplicationData.weekActivities.labelsPerVisit.push(a[0]+": "+a[1]+" times per visit")});for(var D in allApplicationData.weekActivityTypes.rawValues){var w=allApplicationData.weekActivityTypes.data.length;allApplicationData.weekActivityTypes.data.push([]),allApplicationData.weekActivityTypes.data[w].push(D),allApplicationData.weekActivityTypes.data[w].push(allApplicationData.weekActivityTypes.rawValues[D]),allApplicationData.weekActivityTypes.dataPerVisit.push([]),allApplicationData.weekActivityTypes.dataPerVisit[w].push(D),allApplicationData.weekActivityTypes.dataPerVisit[w].push(roundTo2(allApplicationData.weekActivityTypes.rawValues[D]/(allApplicationData.totalVisitsForWeek||1)))}sortNumericalArrayDesc(allApplicationData.weekActivityTypes.data,1),sortNumericalArrayDesc(allApplicationData.weekActivityTypes.dataPerVisit,1),allApplicationData.weekActivityTypes.data.forEach(function(a){allApplicationData.weekActivityTypes.labels.push(a[0]+": "+a[1]+" ("+Math.round(a[1]/(allApplicationData.weekActivities.totalActivities||1)*100)+"%)")}),allApplicationData.weekActivityTypes.dataPerVisit.forEach(function(a){allApplicationData.weekActivityTypes.labelsPerVisit.push(a[0]+": "+a[1]+" times per visit")})}return gaRequester.queryGA({"start-date":formatDateString(lastYearStartDate,"query"),"end-date":formatDateString(lastYearEndDate,"query"),ids:ids,dimensions:"ga:pageTitle,ga:yearMonth,ga:nthMonth,ga:eventLabel",metrics:"ga:totalEvents",filters:topPagesFilter+";ga:eventLabel!=Victoria;ga:eventLabel!=Map;ga:eventLabel!=Imagery;ga:eventAction==click",sort:"ga:pageTitle,ga:yearMonth,ga:nthMonth","max-results":1e4})}).then(function(t){if(t){t.rows.forEach(function(a){var t=retrieveActivityType(a[3]);applicationData[a[0]].yearActivities.rawValues[a[3]]||(applicationData[a[0]].yearActivities.rawValues[a[3]]=[0,0,0,0,0,0,0,0,0,0,0,0]),applicationData[a[0]].yearActivityTypes.rawValues[t]||(applicationData[a[0]].yearActivityTypes.rawValues[t]=[0,0,0,0,0,0,0,0,0,0,0,0]),applicationData[a[0]].yearActivities.rawValues[a[3]][+a[2]]=+a[4],applicationData[a[0]].yearActivityTypes.rawValues[t][+a[2]]+=+a[4],applicationData[a[0]].yearActivities.monthTotals[+a[2]]+=+a[4],allApplicationData.yearActivities.rawValues[a[3]]||(allApplicationData.yearActivities.rawValues[a[3]]=[0,0,0,0,0,0,0,0,0,0,0,0]),allApplicationData.yearActivities.rawValues[a[3]][+a[2]]+=+a[4],allApplicationData.yearActivityTypes.rawValues[t]||(allApplicationData.yearActivityTypes.rawValues[t]=[0,0,0,0,0,0,0,0,0,0,0,0]),allApplicationData.yearActivityTypes.rawValues[t][+a[2]]+=+a[4],allApplicationData.yearActivities.monthTotals[+a[2]]+=+a[4]});for(var e in applicationData){for(var i in applicationData[e].yearActivities.rawValues){var r=applicationData[e].yearActivities.data.length;applicationData[e].yearActivities.data.push([]),applicationData[e].yearActivities.data[r].push(i);for(var s=0;12>s;s++)applicationData[e].yearActivities.data[r].push(roundTo2(applicationData[e].yearActivities.rawValues[i][s]/(applicationData[e].yearActivities.monthTotals[s]||1)*100))}for(var l in applicationData[e].yearActivityTypes.rawValues){var o=applicationData[e].yearActivityTypes.data.length;applicationData[e].yearActivityTypes.data.push([]),applicationData[e].yearActivityTypes.data[o].push(l);for(var n=0;12>n;n++)applicationData[e].yearActivityTypes.data[o].push(roundTo2(applicationData[e].yearActivityTypes.rawValues[l][n]/(applicationData[e].yearActivities.monthTotals[n]||1)*100))}}for(var c in allApplicationData.yearActivities.rawValues){var p=allApplicationData.yearActivities.data.length;allApplicationData.yearActivities.data.push([]),allApplicationData.yearActivities.data[p].push(c);for(var d=0;12>d;d++)allApplicationData.yearActivities.data[p].push(roundTo2(allApplicationData.yearActivities.rawValues[c][d]/(allApplicationData.yearActivities.monthTotals[d]||1)*100))}for(var u in allApplicationData.yearActivityTypes.rawValues){var y=allApplicationData.yearActivityTypes.data.length;allApplicationData.yearActivityTypes.data.push([]),allApplicationData.yearActivityTypes.data[y].push(u);for(var h=0;12>h;h++)allApplicationData.yearActivityTypes.data[y].push(roundTo2(allApplicationData.yearActivityTypes.rawValues[u][h]/(allApplicationData.yearActivities.monthTotals[h]||1)*100))}}a(!0)})["catch"](function(a){console.log(a),t(a)})})}function retrieveActivityType(a){"use strict";assert("string"==typeof a&&""!==a,"retrieveActivityType assert failed - activity: "+a),assert(Array.isArray(clickLookupCategories),"retrieveActivityType assert failed - clickLookupCategories array is not present");for(var t=0;t<clickLookupCategories.length;t++)for(var e=0;e<clickLookupCategories[t].event_labels.length;e++)if(clickLookupCategories[t].event_labels[e]===a)return clickLookupCategories[t].caption;return""}function roundTo2(a){"use strict";return assert("number"==typeof a,"roundTo2 assert failed - numValue: "+a),parseFloat(parseFloat(a).toFixed(2))}function isDate(a){"use strict";var t=new Date(a);return isNaN(t.getMonth())?!1:!0}function endDatePreviousMonth(a){"use strict";assert(isDate(a),"endDatePreviousMonth assert failed - dateValue: "+a);var t=new Date(a);return t.setDate(0),t}function dateAdd(a,t,e){"use strict";assert(isDate(a),"dateAdd assert failed - dateValue: "+a),assert("d"===t||"m"===t||"y"===t,"dateAdd assert failed - unit: "+t),assert("number"==typeof e,"dateAdd assert failed - number: "+e);var i=new Date(a),r={};return r.years=i.getFullYear(),r.months=i.getMonth(),r.days=i.getDate(),"d"===t?i.setDate(r.days+e):"m"===t?i.setMonth(r.months+e):"y"===t&&i.setFullYear(r.years+e),i}function formatDateString(a,t){"use strict";assert(isDate(a),"formatDateString assert failed - dateExpression: "+a),assert("query"===t||"display"===t,"formatDateString assert failed - format: "+t);var e=new Date(a),i={};return i.years=e.getFullYear(),i.months=e.getMonth()+1,i.days=e.getDate(),"query"===t?i.years+"-"+zeroPad(i.months,2)+"-"+zeroPad(i.days,2):zeroPad(i.days,2)+"/"+zeroPad(i.months,2)+"/"+i.years}function convertGADate(a,t){"use strict";return assert(8===a.length&&"number"==typeof a,"convertGADate assert failed - gaDateString: "+a),assert("query"===t||"display"===t,"convertGADate assert failed - format: "+t),"query"===t?a.slice(0,4)+"-"+a.slice(4,6)+"-"+a.slice(6,8):a.slice(6,8)+"/"+a.slice(4,6)+"/"+a.slice(0,4)}function sortNumericalArrayAsc(a){"use strict";assert(Array.isArray(a),"sortNumericalArrayAsc assert failed - numericalArray: "+a),a.sort(function(a,t){return a-t})}function sortNumericalArrayDesc(a,t){"use strict";assert(Array.isArray(a),"sortNumericalArrayDesc assert failed - numericalArray: "+a),assert("undefined"==typeof t||"number"==typeof t,"sortNumericalArrayDesc assert failed - arrayIndex: "+t),"undefined"==typeof t?a.sort(function(a,t){return t-a}):a.sort(function(a,e){return e[t]-a[t]})}function zeroPad(a,t){assert("number"==typeof a,"zeroPad assert failed - number: "+a),assert("number"==typeof t,"zeroPad assert failed - length: "+t);for(var e=a.toString();e.length<t;)e="0"+e;return e}function updateScreenDateSelection(a){document.getElementById("weekSelector").value=formatDateString(a,"query")}function showLoadBar(){loadBar.classList.remove("hidden")}function hideLoadBar(){loadBar.classList.add("hidden")}function loadSubPage(a){var t=["#overall","#lassi","#lassi-spear","#smes","#vicnames","#landata-tpi","#landata-vmt"],e=t.indexOf(window.location.hash),i=document.getElementById("page-title"),r=document.getElementById("header-element"),s=["mdl-color--blue","mdl-color--red","mdl-color--indigo","mdl-color--green","mdl-color--deep-orange","mdl-color--deep-purple","mdl-color--teal"];"undefined"==typeof a&&(a="any");for(var l=0;l<s.length;l++)r.classList.remove(s[l]);e>=0?("home"!==a&&showScreen(window.location.hash.substr(1)),updateActiveLinks(window.location.hash.substr(1)),r.classList.add(s[e]),0===e?i.textContent="Overall LASSI applications usage stats and trends":i.textContent=APP_LABELS[e-1]+" usage stats and trends"):("specific"!==a&&showHomeScreen(),updateActiveLinks("home"),i.textContent="LASSI applications usage stats and trends")}function updateActiveLinks(a){var t,e;for(t=document.getElementsByClassName("active-link"),e=0;e<t.length;e++)t[e].classList.remove("hidden");for(t=document.getElementsByClassName("inactive-link"),e=0;e<t.length;e++)t[e].classList.remove("is-selected"),t[e].classList.remove("mdl-color-text--blue-200"),t[e].classList.remove("mdl-color-text--grey"),t[e].classList.add("hidden");document.getElementById(a+"-link").classList.add("hidden"),document.getElementById(a+"-non-link").classList.remove("hidden"),document.getElementById(a+"-non-link").classList.add("is-selected"),document.getElementById(a+"-non-link").classList.add("mdl-color-text--cyan-100"),document.getElementById("drawer-"+a+"-link").classList.add("hidden"),document.getElementById("drawer-"+a+"-non-link").classList.remove("hidden"),document.getElementById("drawer-"+a+"-non-link").classList.add("is-selected"),document.getElementById("drawer-"+a+"-non-link").classList.add("mdl-color-text--black")}function disableAllLinks(){var a,t;for(a=document.getElementsByClassName("active-link"),t=0;t<a.length;t++)a[t].classList.add("hidden");for(a=document.getElementsByClassName("inactive-link"),t=0;t<a.length;t++)a[t].classList.remove("hidden"),a[t].classList.add("mdl-color-text--grey")}function createMasonry(){"use strict";msnry=new Masonry(parentElement,{itemSelector:".card",columnWidth:".grid-sizer",transitionDuration:"0.4s"})}function refreshCharts(){"use strict";refreshQueue.length=0;for(var a=0;a<chartRefs.length;a++)refreshQueue.push(a);window.setTimeout(function(){executeRefresh()},500)}function executeRefresh(){"use strict";if(refreshQueue.length>0){var a=refreshQueue.pop();"undefined"!=typeof chartRefs[a].chart&&chartRefs[a].chart.flush(),window.setTimeout(function(){executeRefresh()},100)}else msnry.layout()}function createElement(a,t,e,i,r,s){"use strict";if(assert("undefined"!=typeof a,"createElement assert failed - elementId: "+a),assert("undefined"!=typeof e,"createElement assert failed - elementHTML: "+e),assert("undefined"!=typeof i&&"undefined"!=typeof r&&"number"==typeof s||"undefined"==typeof i&&"undefined"==typeof r&&"undefined"==typeof s,"createElement assert failed - button parameters: "+i+", "+r+", "+s),null===document.getElementById(a)){var l=document.createElement("div");if(l.id=a,l.className=t,l.innerHTML=e,parentElement.appendChild(l),msnry.appended(l),"undefined"!=typeof i){var o=document.getElementById(i);"transformArea"===r?o.addEventListener("click",function(){o.classList.contains("area-chart")?(o.innerHTML='<i class="material-icons">timeline</i>',o.classList.add("bar-chart"),o.classList.remove("area-chart")):(o.innerHTML='<i class="material-icons">equalizer</i>',o.classList.add("area-chart"),o.classList.remove("bar-chart")),transformArea(s)},!1):"transformHorizontalStackedGrouped"===r?o.addEventListener("click",function(){o.classList.contains("stacked-chart")?(o.innerHTML='<i class="material-icons">sort</i>',o.classList.add("grouped-chart"),o.classList.remove("stacked-chart")):(o.innerHTML='<i class="material-icons">view_carousel</i>',o.classList.add("stacked-chart"),o.classList.remove("grouped-chart")),transformHorizontalStackedGrouped(s)},!1):"transformVerticalStackedGrouped"===r&&o.addEventListener("click",function(){o.classList.contains("stacked-chart")?(o.innerHTML='<i class="material-icons">equalizer</i>',o.classList.add("grouped-chart"),o.classList.remove("stacked-chart")):(o.innerHTML='<i class="material-icons">view_column</i>',o.classList.add("stacked-chart"),o.classList.remove("grouped-chart")),transformVerticalStackedGrouped(s)},!1)}}}function clearChartsFromScreen(){for(chartRefs.length=0;parentElement.firstChild;)"undefined"!=typeof msnry&&msnry.remove(parentElement.firstChild),parentElement.removeChild(parentElement.firstChild);var a=document.createElement("div");a.className="grid-sizer",parentElement.appendChild(a),"undefined"!=typeof msnry&&msnry.layout()}function showHomeScreen(){clearChartsFromScreen(),buildWeeklyUsersCharts()}function showScreen(a){showLoadBar(),clearChartsFromScreen();for(var t="",e=0;e<ELEMENT_NAMES.length;e++)if(ELEMENT_NAMES[e]===a){t=APP_NAMES[e];break}buildChartsForType(a,t),document.getElementById("weekly-search-"+a+"-switch-to-per-button").addEventListener("click",function(){switchVisibleChart("weekly-search-per-"+a+"-card",["weekly-search-"+a+"-card"])},!1),document.getElementById("weekly-search-"+a+"-switch-to-raw-button").addEventListener("click",function(){switchVisibleChart("weekly-search-"+a+"-card",["weekly-search-per-"+a+"-card"])},!1),document.getElementById("weekly-activity-types-"+a+"-switch-to-per-button").addEventListener("click",function(){switchVisibleChart("weekly-activity-types-per-"+a+"-card",["weekly-activity-types-"+a+"-card","weekly-activities-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),document.getElementById("weekly-activity-types-"+a+"-switch-to-raw-activities-button").addEventListener("click",function(){switchVisibleChart("weekly-activities-"+a+"-card",["weekly-activity-types-per-"+a+"-card","weekly-activity-types-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),document.getElementById("weekly-activity-types-"+a+"-switch-to-raw-button").addEventListener("click",function(){switchVisibleChart("weekly-activity-types-"+a+"-card",["weekly-activity-types-per-"+a+"-card","weekly-activities-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),document.getElementById("weekly-activity-types-"+a+"-switch-to-per-activities-button").addEventListener("click",function(){switchVisibleChart("weekly-activities-per-"+a+"-card",["weekly-activity-types-"+a+"-card","weekly-activity-types-per-"+a+"-card","weekly-activities-"+a+"-card"])},!1),document.getElementById("weekly-activities-"+a+"-switch-to-per-button").addEventListener("click",function(){switchVisibleChart("weekly-activities-per-"+a+"-card",["weekly-activity-types-"+a+"-card","weekly-activity-types-per-"+a+"-card","weekly-activities-"+a+"-card"])},!1),document.getElementById("weekly-activities-"+a+"-switch-to-raw-activity-types-button").addEventListener("click",function(){switchVisibleChart("weekly-activity-types-"+a+"-card",["weekly-activities-"+a+"-card","weekly-activity-types-per-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),document.getElementById("weekly-activities-"+a+"-switch-to-raw-button").addEventListener("click",function(){switchVisibleChart("weekly-activities-"+a+"-card",["weekly-activity-types-"+a+"-card","weekly-activity-types-per-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),document.getElementById("weekly-activities-"+a+"-switch-to-per-activity-types-button").addEventListener("click",function(){switchVisibleChart("weekly-activity-types-per-"+a+"-card",["weekly-activity-types-"+a+"-card","weekly-activities-"+a+"-card","weekly-activities-per-"+a+"-card"])},!1),hideLoadBar()}function switchVisibleChart(a,t){var e,i=document.getElementById(a);if("undefined"!=typeof i){i.classList.remove("hidden");for(var r=0;r<chartRefs.length;r++)if(document.getElementById(chartRefs[r].pageElement).parentElement.parentElement.id===a){chartRefs[r].chart.flush();break}}for(var s=0;s<t.length;s++)e=document.getElementById(t[s]),"undefined"!=typeof e&&e.classList.add("hidden");msnry.layout()}function buildWeeklyUsersCharts(){"use strict";var a,t,e,i=[],r=chartRefs.length;a=["Week starting "+formatDateString(startDate,"display")],t=["Week starting "+formatDateString(lastWeekStartDate,"display")],e=["Median for the last year"],Array.prototype.push.apply(a,allApplicationData.currentWeekUserData),Array.prototype.push.apply(t,allApplicationData.lastWeekUserData),Array.prototype.push.apply(e,allApplicationData.lastYearMedianUserData),i.push(currentWeekdayLabels),i.push(e),i.push(t),i.push(a),createElement("weekly-users-overall-card","card full-width home overall",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Visits across all applications for the week</div><button id="weekly-users-overall-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon area-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="weekly-users-overall-button">Switch between line chart and bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-users-overall"></div></div>',"weekly-users-overall-button","transformArea",r),chartRefs[r]=new C3StatsChart(i,"weekly-users-overall"),chartRefs[r].createWeekDayAreaChart();for(var s=0;s<APP_NAMES.length;s++){a=["Week starting "+formatDateString(startDate,"display")],t=["Week starting "+formatDateString(lastWeekStartDate,"display")],e=["Median for the last year"],i=[];var l=chartRefs.length;Array.prototype.push.apply(a,applicationData[APP_NAMES[s]].currentWeekUserData),Array.prototype.push.apply(t,applicationData[APP_NAMES[s]].lastWeekUserData),Array.prototype.push.apply(e,applicationData[APP_NAMES[s]].lastYearMedianUserData),i.push(currentWeekdayLabels),i.push(e),i.push(t),i.push(a),createElement("weekly-users-"+ELEMENT_NAMES[s]+"-card","card home "+ELEMENT_NAMES[s],'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">'+APP_LABELS[s]+' visits for the week</div><button id="weekly-users-'+ELEMENT_NAMES[s]+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon area-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="weekly-users-'+ELEMENT_NAMES[s]+'-button">Switch between line chart and bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-users-'+ELEMENT_NAMES[s]+'"></div></div>',"weekly-users-"+ELEMENT_NAMES[s]+"-button","transformArea",l),chartRefs[l]=new C3StatsChart(i,"weekly-users-"+ELEMENT_NAMES[s]),chartRefs[l].createWeekDayAreaChart()}refreshCharts(),msnry.layout(),componentHandler.upgradeAllRegistered()}function buildChartsForType(a,t){"use strict";var e,i,r,s,l,o,n,c,p,d,u="card half-width "+a;if(d="overall"===a?allApplicationData:applicationData[t],"overall"===a){c=[],p=chartRefs.length;for(var y=0;y<APP_NAMES.length;y++)c.push([]),c[c.length-1].push(APP_LABELS[y]),Array.prototype.push.apply(c[c.length-1],d.pageData[APP_NAMES[y]]);createElement("yearly-pages-overall-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Visit breakdown by application for the year</div><button id="yearly-pages-overall-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon area-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="yearly-pages-overall-button">Switch between stacked bar chart and grouped bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-pages-overall"></div></div>',"yearly-pages-overall-button","transformVerticalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"yearly-pages-overall",last12MonthsLabels,APP_LABELS),chartRefs[p].createStackedVerticalBarChart("Percentage of visits")}c=[],e=["Week starting "+formatDateString(startDate,"display")],i=["Week starting "+formatDateString(lastWeekStartDate,"display")],r=["Median for the last year"],p=chartRefs.length,Array.prototype.push.apply(e,d.currentWeekUserData),Array.prototype.push.apply(i,d.lastWeekUserData),Array.prototype.push.apply(r,d.lastYearMedianUserData),c.push(currentWeekdayLabels),c.push(r),c.push(i),c.push(e),createElement("weekly-users-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall visits for the week</div><button id="weekly-users-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon area-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="weekly-users-'+a+'-button">Switch between line chart and bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-users-'+a+'"></div></div>',"weekly-users-"+a+"-button","transformArea",p),
chartRefs[p]=new C3StatsChart(c,"weekly-users-"+a),chartRefs[p].createWeekDayAreaChart(),c=[],s=["Previous year"],l=["Current year"],p=chartRefs.length,Array.prototype.push.apply(s,d.previousYearUserData),Array.prototype.push.apply(l,d.thisYearUserData),c.push(s),c.push(l),createElement("yearly-users-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall year over year visit comparison</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-users-'+a+'"></div></div>'),chartRefs[p]=new C3StatsChart(c,"yearly-users-"+a,last12MonthsLabels),chartRefs[p].createStaticVerticalTwoSeriesBarChart(),c=[],p=chartRefs.length,e=["Week starting "+formatDateString(startDate,"display")],i=["Week starting "+formatDateString(lastWeekStartDate,"display")],r=["Median for the last year"],Array.prototype.push.apply(e,d.currentWeekSessionData),Array.prototype.push.apply(i,d.lastWeekSessionData),Array.prototype.push.apply(r,d.lastYearMedianSessionData),c.push(currentWeekdayLabels),c.push(r),c.push(i),c.push(e),createElement("weekly-sessions-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall duration of visits for the week</div><button id="weekly-sessions-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon area-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="weekly-sessions-'+a+'-button">Switch between line chart and bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-sessions-'+a+'"></div></div>',"weekly-sessions-"+a+"-button","transformArea",p),chartRefs[p]=new C3StatsChart(c,"weekly-sessions-"+a),chartRefs[p].createWeekDayAreaChart(),c=d.visitorReturns.data.slice(),o=d.visitorReturns.labels.slice(),n=[],p=chartRefs.length,d.visitorReturns.data.forEach(function(a){n.push(a[0])}),createElement("visitor-return-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall time between visits</div><button id="visitor-return-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="visitor-return-'+a+'-button">Switch between separate values and stacked values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="visitor-return-'+a+'"></div></div>',"visitor-return-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"visitor-return-"+a,o,n),chartRefs[p].createHorizontalBarChart("Time to return"),c=[],p=chartRefs.length;for(var h=0;h<topBrowsersArray.length;h++)c.push([]),c[c.length-1].push(topBrowsersArray[h]),Array.prototype.push.apply(c[c.length-1],d.browserData[topBrowsersArray[h]]);createElement("yearly-browsers-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall browser usage for the year</div><button id="yearly-browsers-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="yearly-browsers-'+a+'-button">Switch between stacked bar chart and grouped bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-browsers-'+a+'"></div></div>',"yearly-browsers-"+a+"-button","transformVerticalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"yearly-browsers-"+a,last12MonthsLabels,topBrowsersArray),chartRefs[p].createStackedVerticalBarChart("Percentage of visits"),c=d.weekMapTypes.data.slice(),o=d.weekMapTypes.labels.slice(),n=[],p=chartRefs.length,d.weekMapTypes.data.forEach(function(a){n.push(a[0])}),createElement("weekly-maps-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall map selection for the week</div><button id="weekly-maps-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-maps-'+a+'-button">Switch between separate values and stacked values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-maps-'+a+'"></div></div>',"weekly-maps-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-maps-"+a,o,n),chartRefs[p].createHorizontalBarChart("Map type"),c=d.yearMapTypes.data.slice(),n=[],p=chartRefs.length,d.yearMapTypes.data.forEach(function(a){n.push(a[0])}),createElement("yearly-maps-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall map selection for the year</div><button id="yearly-maps-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="yearly-maps-'+a+'-button">Switch between stacked bar chart and grouped bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-maps-'+a+'"></div></div>',"yearly-maps-"+a+"-button","transformVerticalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"yearly-maps-"+a,last12MonthsLabels,n),chartRefs[p].createStackedVerticalBarChart("Percentage of map types"),c=d.weekSearchTypes.data.slice(),o=d.weekSearchTypes.labels.slice(),n=[],p=chartRefs.length,d.weekSearchTypes.data.forEach(function(a){n.push(a[0])}),createElement("weekly-search-"+a+"-card",u+" raw",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall searches for the week</div><button id="weekly-search-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-search-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-search-'+a+'-switch-to-per-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_right</i></button><div class="mdl-tooltip" for="weekly-search-'+a+'-switch-to-per-button">Switch to per visit values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-search-'+a+'"></div></div>',"weekly-search-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-search-"+a,o,n),chartRefs[p].createHorizontalBarChart("Search type"),c=d.weekSearchTypes.dataPerVisit.slice(),o=d.weekSearchTypes.labelsPerVisit.slice(),n=[],p=chartRefs.length,d.weekSearchTypes.data.forEach(function(a){n.push(a[0])}),createElement("weekly-search-per-"+a+"-card",u+" per-visit hidden",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall searches per visit for the week</div><button id="weekly-search-per-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-search-per-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-search-'+a+'-switch-to-raw-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_left</i></button><div class="mdl-tooltip" for="weekly-search-'+a+'-switch-to-raw-button">Switch to raw values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-search-per-'+a+'"></div></div>',"weekly-search-per-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-search-per-"+a,o,n),chartRefs[p].createHorizontalBarChart("Search type"),c=d.yearSearchTypes.data.slice(),p=chartRefs.length,n=[],d.yearSearchTypes.data.forEach(function(a){n.push(a[0])}),createElement("yearly-search-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall searches for the year</div><button id="yearly-search-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="yearly-search-'+a+'-button">Switch between stacked bar chart and grouped bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-search-'+a+'"></div></div>',"yearly-search-"+a+"-button","transformVerticalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"yearly-search-"+a,last12MonthsLabels,n),chartRefs[p].createStackedVerticalBarChart("Percentage of searches"),c=d.weekActivityTypes.data.slice(),o=d.weekActivityTypes.labels.slice(),n=[],p=chartRefs.length,d.weekActivityTypes.data.forEach(function(a){n.push(a[0])}),createElement("weekly-activity-types-"+a+"-card",u+" raw",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall activity types for the week</div><button id="weekly-activity-types-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-activity-types-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-activity-types-'+a+'-switch-to-per-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_right</i></button><div class="mdl-tooltip" for="weekly-activity-types-'+a+'-switch-to-per-button">Switch to per visit values</div><button id="weekly-activity-types-'+a+'-switch-to-raw-activities-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">zoom_in</i></button><div class="mdl-tooltip" for="weekly-activity-types-'+a+'-switch-to-raw-activities-button">Switch to detailed activity values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-activity-types-'+a+'"></div></div>',"weekly-activity-types-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-activity-types-"+a,o,n),chartRefs[p].createHorizontalBarChart("Activity type"),c=d.weekActivityTypes.dataPerVisit.slice(),o=d.weekActivityTypes.labelsPerVisit.slice(),n=[],p=chartRefs.length,d.weekActivityTypes.data.forEach(function(a){n.push(a[0])}),createElement("weekly-activity-types-per-"+a+"-card",u+" per-visit hidden",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall activity types per visit for the week</div><button id="weekly-activity-types-per-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-activity-types-per-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-activity-types-'+a+'-switch-to-raw-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_left</i></button><div class="mdl-tooltip" for="weekly-activity-types-'+a+'-switch-to-raw-button">Switch to raw values</div><button id="weekly-activity-types-'+a+'-switch-to-per-activities-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">zoom_in</i></button><div class="mdl-tooltip" for="weekly-activity-types-'+a+'-switch-to-per-activities-button">Switch to detailed activity values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-activity-types-per-'+a+'"></div></div>',"weekly-activity-types-per-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-activity-types-per-"+a,o,n),chartRefs[p].createHorizontalBarChart("Activity type"),c=d.weekActivities.data.slice(),o=d.weekActivities.labels.slice(),n=[],p=chartRefs.length,d.weekActivities.data.forEach(function(a){n.push(a[0])}),createElement("weekly-activities-"+a+"-card",u+" details hidden",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall activity breakdown for the week</div><button id="weekly-activities-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-activities-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-activities-'+a+'-switch-to-per-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_right</i></button><div class="mdl-tooltip" for="weekly-activities-'+a+'-switch-to-per-button">Switch to per visit values</div><button id="weekly-activities-'+a+'-switch-to-raw-activity-types-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">zoom_out</i></button><div class="mdl-tooltip" for="weekly-activities-'+a+'-switch-to-raw-activity-types-button">Switch to grouped activity type values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-activities-'+a+'"></div></div>',"weekly-activities-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-activities-"+a,o,n),chartRefs[p].createHorizontalBarChart("Activity"),c=d.weekActivities.dataPerVisit.slice(),o=d.weekActivities.labelsPerVisit.slice(),n=[],p=chartRefs.length,d.weekActivities.data.forEach(function(a){n.push(a[0])}),createElement("weekly-activities-per-"+a+"-card",u+" details-per-visit hidden",'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall activity breakdown per visit for the week</div><button id="weekly-activities-per-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">view_carousel</i></button><div class="mdl-tooltip" for="weekly-activities-per-'+a+'-button">Switch between separate values and stacked values</div><button id="weekly-activities-'+a+'-switch-to-raw-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">subdirectory_arrow_left</i></button><div class="mdl-tooltip" for="weekly-activities-'+a+'-switch-to-raw-button">Switch to raw values</div><button id="weekly-activities-'+a+'-switch-to-per-activity-types-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">zoom_out</i></button><div class="mdl-tooltip" for="weekly-activities-'+a+'-switch-to-per-activity-types-button">Switch to grouped activity type values</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="weekly-activities-per-'+a+'"></div></div>',"weekly-activities-per-"+a+"-button","transformHorizontalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"weekly-activities-per-"+a,o,n),chartRefs[p].createHorizontalBarChart("Activity"),c=d.yearActivityTypes.data.slice(),p=chartRefs.length,n=[],d.yearActivityTypes.data.forEach(function(a){n.push(a[0])}),createElement("yearly-activity-types-"+a+"-card",u,'<div class="card-top-spacer"></div><div class="mdl-typography--title chart-title">Overall activity types for the year</div><button id="yearly-activity-types-'+a+'-button" class="mdl-button mdl-js-button mdl-button--icon chart-icon stacked-chart"><i class="material-icons">equalizer</i></button><div class="mdl-tooltip" for="yearly-activity-types-'+a+'-button">Switch between stacked bar chart and grouped bar chart</div><div class="card-bottom-spacer"></div><div class="mdl-card__actions mdl-card--border"><div id="yearly-activity-types-'+a+'"></div></div>',"yearly-activity-types-"+a+"-button","transformVerticalStackedGrouped",p),chartRefs[p]=new C3StatsChart(c,"yearly-activity-types-"+a,last12MonthsLabels,n),chartRefs[p].createStackedVerticalBarChart("Percentage of activities"),refreshCharts(),msnry.layout(),componentHandler.upgradeAllRegistered()}function transformArea(a){"use strict";chartRefs[a].transformAreaBar()}function transformHorizontalStackedGrouped(a){"use strict";chartRefs[a].transformHorizontalStackedGrouped()}function transformVerticalStackedGrouped(a){"use strict";chartRefs[a].transformVerticalStackedGrouped()}var RateLimitedPromises=function(a){"use strict";this.promiseQueue=[],"number"==typeof a.noRequests?this.maxRequests=a.noRequests:this.maxRequests=1,"number"==typeof a.perNumberOfSeconds?this.perNumberOfSeconds=a.perNumberOfSeconds:this.perNumberOfSeconds=1,this.lastQueueExecuteStartTime=0};RateLimitedPromises.prototype.queuePromise=function(a){"use strict";var t=this;return new Promise(function(e,i){t.promiseQueue.push({resolve:e,reject:i,promise:a}),t.processQueue()})},RateLimitedPromises.prototype.processQueue=function(){"use strict";var a=this,t=a.perNumberOfSeconds/a.maxRequests*1e3,e=Date.now()-a.lastQueueExecuteStartTime;a.promiseQueue.length>0&&(e>=t?a.executePromiseFromQueue():window.setTimeout(function(){a.processQueue()},t-e+50))},RateLimitedPromises.prototype.executePromiseFromQueue=function(){"use strict";var a=this;if(a.promiseQueue.length>0){a.lastQueueExecuteStartTime=Date.now();var t=a.promiseQueue.shift();t.promise().then(function(a){t.resolve(a)})["catch"](function(a){t.reject(a)})}},RateLimitedPromises.prototype.clearQueue=function(){"use strict";var a=this;a.promiseQueue.length=0};var GARequests=function(a){"use strict";this.rateLimitedPromises=new RateLimitedPromises({noRequests:a,perNumberOfSeconds:1})};GARequests.prototype.queryGA=function(a){"use strict";var t=this;return new Promise(function(e,i){var r=function(){return new Promise(function(t,e){var i=new gapi.analytics.report.Data({query:a});i.once("success",function(a){t(a)}).once("error",function(a){e(a)}).execute()})};t.rateLimitedPromises.queuePromise(r).then(function(a){e(a.totalResults>0?{columHeaders:a.columnHeaders,rows:a.rows}:null)})["catch"](function(a){i(a)})})},GARequests.prototype.clearQueryQueue=function(a){"use strict";this.rateLimitedPromises.clearQueue()};var C3StatsChart=function(a,t,e,i){"use strict";this.columnData=a,"undefined"!=typeof e?(this.labels=e,this.groupValues=e):this.labels=[],"undefined"!=typeof i?(this.seriesLabels=i,this.groupValues=i):this.seriesLabels=[],this.chartFormat="",this.chartType="",this.chartMaxIndValue=0,this.chartMaxTotalValue=0,this.barOrArea="",this.pageElement=t,this.horizontalLabelClassName="",this.transitionDuration=1e3};C3StatsChart.prototype.createWeekDayAreaChart=function(){"use strict";var a=this;a.chartFormat="WeekDayAreaChart",a.chartType="area-spline",a.chart=c3.generate({bindto:document.getElementById(a.pageElement),transition:{duration:a.transitionDuration},padding:{left:75,bottom:20,right:20,top:20},point:{r:4},data:{x:"x",columns:a.columnData,type:"area-spline"},axis:{x:{type:"timeseries",tick:{format:"%a",outer:!1,centered:!1}},y:{padding:{left:0},tick:{format:function(a){return a/1e3>=10&&(a=a/1e3+"K"),a}}}},grid:{x:{show:!0},y:{show:!0},focus:{show:!0}},area:{zerobased:!0},color:{pattern:chartColors.smallSets[3]},bar:{width:{ratio:.85}}})},C3StatsChart.prototype.createStaticVerticalTwoSeriesBarChart=function(){"use strict";var a=this;a.chartFormat="StaticVerticalTwoSeriesBarChart",a.chart=c3.generate({bindto:document.getElementById(a.pageElement),transition:{duration:a.transitionDuration},padding:{left:75,bottom:20,right:20,top:20},point:{r:4},data:{columns:a.columnData,type:"bar"},axis:{x:{type:"category",categories:a.labels,padding:{left:0,right:0},tick:{centered:!0,outer:!1,fit:!1,count:a.labels.length,width:500}},y:{padding:{left:0},tick:{format:function(a){return a/1e3>=10&&(a=a/1e3+"K"),a}}}},grid:{x:{show:!0},y:{show:!0},focus:{show:!0}},bar:{width:{ratio:.85}},color:{pattern:chartColors.smallSets[2]}})},C3StatsChart.prototype.createStackedVerticalBarChart=function(a){"use strict";var t=this;t.chartFormat="StackedVerticalBarChart",t.chartType="grouped";var e=15*t.columnData.length;350>e&&(e=350);var i;i=document.getElementById(t.pageElement)?document.getElementById(t.pageElement).clientWidth:500,t.chart=c3.generate({bindto:document.getElementById(t.pageElement),transition:{duration:t.transitionDuration},padding:{bottom:20,left:75,right:20,top:20},size:{height:e,width:i},data:{columns:t.columnData,type:"bar",groups:[t.seriesLabels],order:"asc"},axis:{x:{type:"category",categories:t.labels},y:{label:{text:a||"",position:"outer-middle"},padding:{top:0},tick:{format:function(a){return a/1e3>=10&&(a=a/1e3+"K"),a}}}},grid:{x:{show:!0},y:{show:!0,max:100,padding:{top:0,bottom:0}},focus:{show:!0}},bar:{width:{ratio:.95}},tooltip:{grouped:!0},color:{pattern:chartColors.bigSets[20]},onresized:function(){var a;a=document.getElementById(t.pageElement)?document.getElementById(t.pageElement).clientWidth:500,t.chart.resize({height:e,width:a})}})},C3StatsChart.prototype.createHorizontalBarChart=function(a){"use strict";var t=this;t.chartFormat="HorizontalBarChart",t.chartType="individual",t.verticalAxisLabel=a,t.chartMaxIndValue=0,t.chartMaxTotalValue=0;var e={},i=50*t.columnData.length;350>i&&(i=350);var r;r=document.getElementById(t.pageElement)?document.getElementById(t.pageElement).clientWidth:500,t.columnData.forEach(function(a){a.forEach(function(a){"number"==typeof a&&(t.chartMaxTotalValue=t.chartMaxTotalValue+a,a>t.chartMaxIndValue&&(t.chartMaxIndValue=a))})}),t.horizontalLabelClassName="horizontal-label-position",t.columnData.forEach(function(a){e[a[0]]=t.horizontalLabelClassName}),t.chart=c3.generate({bindto:document.getElementById(t.pageElement),transition:{duration:t.transitionDuration},size:{height:i,width:r},padding:{bottom:20,left:130,right:20,top:20},data:{columns:t.columnData,type:"bar",labels:{format:function(a,e,i,r){return t.labels[r]}},classes:e},axis:{rotated:!0,x:{type:"category",categories:[a],padding:{left:0,right:0},tick:{count:0}},y:{padding:{left:0},tick:{format:function(a){return a/1e3>=10&&(a=a/1e3+"K"),a}}}},grid:{x:{show:!0},y:{show:!0},focus:{show:!0}},bar:{width:{ratio:.95}},tooltip:{grouped:!0},color:{pattern:chartColors.bigSets[20]},onrendered:function(){t.moveLabelsXPos()},onresized:function(){var a;a=document.getElementById(t.pageElement)?document.getElementById(t.pageElement).clientWidth:500,t.chart.resize({height:i,width:a})}}),t.rescaleHorizontal(.85*t.chartMaxIndValue)},C3StatsChart.prototype.refreshChartData=function(a,t,e){"use strict";var i=this;i.columnData=a,"undefined"!=typeof t&&(i.labels=t,i.groupValues=t),"undefined"!=typeof e&&(i.seriesLabels=e,i.groupValues=e),"WeekDayAreaChart"===i.chartFormat?i.createWeekDayAreaChart():"StaticVerticalTwoSeriesBarChart"===i.chartFormat?i.createStaticVerticalTwoSeriesBarChart():"StackedVerticalBarChart"===i.chartFormat?i.createStackedVerticalBarChart():"HorizontalBarChart"===i.chartFormat&&i.createHorizontalBarChart(i.verticalAxisLabel)},C3StatsChart.prototype.transformHorizontalStackedGrouped=function(){"use strict";var a=this;"individual"===a.chartType?(a.chart.groups([a.groupValues]),a.rescaleHorizontal(.95*a.chartMaxTotalValue),a.chartType="grouped"):(a.chart.groups([]),a.rescaleHorizontal(.85*a.chartMaxIndValue),a.chartType="individual")},C3StatsChart.prototype.transformVerticalStackedGrouped=function(){"use strict";var a=this;"individual"===a.chartType?(a.chart.groups([a.groupValues]),a.chartType="grouped"):(a.chart.groups([]),a.chartType="individual")},C3StatsChart.prototype.transformAreaBar=function(){"use strict";var a=this;"area-spline"===a.chartType?(a.chart.transform("bar"),a.chartType="bar"):(a.chart.transform("area-spline"),a.chartType="area-spline")},C3StatsChart.prototype.moveLabelsXPos=function(){"use strict";var a=this;"individual"===a.chartType?window.setTimeout(function(){d3.selectAll("div#"+a.pageElement+" .c3-target-"+a.horizontalLabelClassName+" .c3-text").attr("x",15).style({fill:"black",opacity:1})},1500):window.setTimeout(function(){d3.selectAll("div#"+a.pageElement+" .c3-target-"+a.horizontalLabelClassName+" .c3-text").style({opacity:0})},1500)},C3StatsChart.prototype.rescaleHorizontal=function(a){"use strict";var t=this;window.setTimeout(function(){t.chart.axis.max({y:a})},0)};var chartColors={bigSets:{13:["#92E5F7","#F3AB67","#FABDE5","#BCE385","#AAB591","#FFA3A8","#9EF1B3","#FEF4A3","#C8E1FF","#BAF6F0","#FBBCBD","#EEA8B5","#AFD0F1"],14:["#FF998E","#89F1F5","#C5CA69","#D3C8F5","#7BD39A","#F49CC0","#E9FFE5","#F9A667","#88C4E5","#A1BEA7","#ACBB7F","#DEF0A2","#9AB8CB","#B1C0ED"],15:["#D1DDF3","#F6BF63","#89C593","#F9B7A9","#F3F4D1","#5CC5C2","#C9D17B","#C0FBF2","#FCB1CD","#CBF8B1","#B4ACB9","#F7DBA4","#7FE4F4","#DAA37E","#D2C7F2"],16:["#B0D2FE","#EDCB65","#F2989C","#8EFCE5","#AADC8D","#E6E4DA","#FACDA0","#D19EC3","#B1C292","#5BC6B5","#CBF6BE","#ADBBD2","#DDA37A","#C0BF5F","#FEE78C","#F3B9D3"],17:["#8DE5E1","#F4A1AA","#B8CC6E","#C0BBE1","#90EEAF","#D0AC72","#FFDAC9","#DBE5EC","#CCFACF","#A8B37E","#FBC1E0","#87B9AB","#F9DC98","#BBF9A3","#D3AFA6","#76F4CA","#F8ADB2"],18:["#72CBCA","#FBC06D","#D8AEDE","#BAEBA2","#EAD9C1","#F49C83","#C3D56C","#80FFE6","#6DBE87","#C6AEB3","#EFF0AE","#BDAE8C","#D5EFCC","#F0D190","#FAD3F5","#FEEFE9","#96C989","#D2B9E9"],19:["#76F6E3","#EEB965","#D4B4E2","#C9F69B","#B4B498","#FEABB4","#92B1BB","#EDD8D6","#81C98E","#F3EFB0","#A7CCF5","#E3A075","#C1F6DC","#68C5B4","#E6D572","#FFC590","#E0FBBB","#C4AF8E","#F5DD86"],20:["#C6E793","#F39187","#A0BCD5","#6FD1B5","#FACD8C","#F8DAE1","#B0F6F6","#FDA06C","#E8E775","#B3B5B1","#C5A880","#C5BF6F","#DBA29B","#B2E9BD","#FACFAB","#91C481","#E3A967","#FFABAC","#C8CCE9","#AAD77A"]},smallSets:{2:["#f57366","#afe064"],3:["#72a1cb","#f57366","#afe064"]}},ASSERT_ENABLED=!0,ASSERT_ERROR=!0,PAGE_TITLE_EXCLUSION_FILTER="ga:PageTitle!=Redirect;ga:PageTitle!=(not set);ga:PageTitle!=Home page;ga:PageTitle!=www.Event-Tracking.com;ga:PageTitle!=News",APP_NAMES=["LASSI - Land and Survey Spatial Information","LASSI - SPEAR","SMES - Survey Marks Enquiry Service","VICNAMES - The Register of Geographic Names","LASSI - TPC","LASSI - VMT"],APP_LABELS=["LASSI","LASSI - SPEAR","SMES","VICNAMES","LANDATA TPI","LANDATA VMT"],MONTH_LABELS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],clickLookupCategories=[{event_labels:["Clear Highlight","Polygon Search. Enabled when zoom scale is 1:10,000 or below.","View Search Results"],caption:"Search"},{event_labels:["Pan: Drag cursor or hold shift key and drag cursor to zoom","Zoom In","Zoom Out","Zoom to Full Extent","Zoom to Greater Melbourne","Zoom to Scale","Go back one page","Go forward one page"],caption:"Move and zoom"},{event_labels:["Historical Information","Identify Aerial Photograph","Identify Property","Identify Survey Labels","Identify Survey Marks","Parcel information: click on map","Identify Feature","Identify Road. Enabled when zoom scale is 1:50,000 or below.","Polygon Search. Enabled when zoom scale is 1:10,000 or below.","View Search Results"],caption:"Retrieve information"},{event_labels:["Add Mark to selection","Clear Selection List","Remove Mark from selection","Display Mark Selection List Window"],caption:"Select & display marks"},{event_labels:["Select Parcel","Unselect Parcel","Complete Selection"],caption:"Map based select"},{event_labels:["Markup tools","Measure Area","Measure Distance","Clear highlight"],caption:"Map tools"},{event_labels:["Save Geo-Referenced Image","Save Image"],caption:"Save image"},{event_labels:["Print Map"],caption:"Print map"},{event_labels:["Activate Document Download Tab","Draw Polygon to Export Survey Information to LandXML","Downoad GNR Data","Export property information","Export Parcels","Open in Google Maps","Street View: click on map"],caption:"Download and export information"},{event_labels:["Add Labels","Administration","Administrator functions","Broadcast Message","Delete Labels","Edit Labels","Check update","Mark Maintenance","Add New GNR Record"],caption:"Administer data"}],topPagesFilter,topBrowsersArray=[],topBrowsersFilter,startDate,endDate,ids,lastWeekStartDate,lastWeekEndDate,lastYearStartDate,lastYearEndDate,previousYearStartDate,previousYearEndDate,retrievalId,gaRequester=new GARequests(5),currentWeekdayLabels=[],last12MonthsLabels=[],allApplicationData=[],applicationData={},ELEMENT_NAMES=["lassi","lassi-spear","smes","vicnames","landata-tpi","landata-vmt"],chartRefs=[],refreshQueue=[],loadBar,msnry,parentElement;window.onload=function(){"use strict";parentElement=document.getElementById("masonry-grid"),createMasonry(),window.addEventListener("hashchange",loadSubPage,!1),loadBar=document.getElementById("load-bar"),showLoadBar();var a=document.getElementById("weekSelector");a.value=formatDateString(returnLastFullWeekDate(),"query"),a.addEventListener("change",function(){var t=new Date;document.getElementById("weekSelector").value>formatDateString(t,"query")&&(document.getElementById("weekSelector").value=formatDateString(t,"query")),showLoadBar(),changeRetrievalDate(a.value)},!1)};